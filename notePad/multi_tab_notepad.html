<!--https://sunil-chakraborty.github.io/sunil-c.github.io/NotePad/
https://tinyurl.com/mynPad
-->


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Tab Notepad with LocalStorage</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .tabs { display: flex; margin-bottom: 10px; flex-wrap: wrap; }
    .tab {
        padding: 8px 12px;
        border: 1px solid #ccc;
        border-bottom: none;
        cursor: pointer;
        background: #f1f1f1;
        margin-right: 5px;
        border-radius: 5px 5px 0 0;
    }
    .tab.active { background: white; font-weight: bold; }
    .tab button {
        margin-left: 5px;
        color: red;
        background: none;
        border: none;
        cursor: pointer;
    }
    textarea { width: 100%; height: 300px; padding: 10px; font-size: 14px; }
    .controls { margin-top: 10px; display: flex; flex-wrap: wrap; gap: 5px; }
</style>
</head>
<body>

<h2>Multi-Tab Notepad</h2>
<div class="tabs" id="tabContainer"></div>
<textarea id="noteArea"></textarea>
<div class="controls">
    <button onclick="newTab()">New Tab</button>
    <button onclick="renameTab()">Rename Tab</button>
    <button onclick="saveToFile()">Save to File</button>
    <button onclick="copySelectedText()">Copy Selected Text</button>
    <button onclick="shareSelectedText()">Share Selected Text</button>
</div>

<script>
let tabs = JSON.parse(localStorage.getItem('notepadTabs')) || [
    { name: 'Tab 1', content: '' },
    { name: 'Tab 2', content: '' },
    { name: 'Tab 3', content: '' }
];
let currentTab = 0;

function saveTabsToStorage() {
    localStorage.setItem('notepadTabs', JSON.stringify(tabs));
}

function renderTabs() {
    const container = document.getElementById('tabContainer');
    container.innerHTML = '';
    tabs.forEach((tab, index) => {
        const tabElement = document.createElement('div');
        tabElement.className = 'tab' + (index === currentTab ? ' active' : '');
        tabElement.innerHTML = `${tab.name} <button onclick="deleteTab(${index}); event.stopPropagation();">&times;</button>`;
        tabElement.onclick = () => switchTab(index);
        container.appendChild(tabElement);
    });
    document.getElementById('noteArea').value = tabs[currentTab]?.content || '';
}

function switchTab(index) {
    saveCurrentContent();
    currentTab = index;
    renderTabs();
}

function saveCurrentContent() {
    if (tabs[currentTab]) {
        tabs[currentTab].content = document.getElementById('noteArea').value;
        saveTabsToStorage();
    }
}

function newTab() {
    saveCurrentContent();
    const name = prompt("Enter new tab name:", `Tab ${tabs.length + 1}`);
    if (name) {
        tabs.push({ name, content: '' });
        currentTab = tabs.length - 1;
        saveTabsToStorage();
        renderTabs();
    }
}

function renameTab() {
    const name = prompt("Enter new tab name:", tabs[currentTab].name);
    if (name) {
        tabs[currentTab].name = name;
        saveTabsToStorage();
        renderTabs();
    }
}

function deleteTab(index) {
    if (confirm(`Delete "${tabs[index].name}"?`)) {
        tabs.splice(index, 1);
        if (currentTab >= tabs.length) currentTab = tabs.length - 1;
        saveTabsToStorage();
        renderTabs();
    }
}

function saveToFile() {
    saveCurrentContent();
    let content = tabs.map(tab => `--- ${tab.name} ---\n${tab.content}`).join("\n\n");
    const blob = new Blob([content], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'notepad_tabs.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

function copySelectedText() {
    const textarea = document.getElementById('noteArea');
    const selectedText = textarea.value.substring(textarea.selectionStart, textarea.selectionEnd);

    if (!selectedText) {
        alert("Please select some text first.");
        return;
    }

    navigator.clipboard.writeText(selectedText).then(() => {
        alert("Selected text copied to clipboard!");
    }).catch(err => {
        console.error("Could not copy text: ", err);
    });
}

function shareSelectedText() {
    const textarea = document.getElementById('noteArea');
    const selectedText = textarea.value.substring(textarea.selectionStart, textarea.selectionEnd);

    if (!selectedText) {
        alert("Please select some text first.");
        return;
    }

    if (navigator.share) {
        navigator.share({
            title: 'Shared from Multi-Tab Notepad',
            text: selectedText
        }).catch(err => {
            console.error("Error sharing: ", err);
        });
    } else {
        alert("Sharing not supported in this browser. Please copy instead.");
    }
}

window.addEventListener('beforeunload', saveCurrentContent);
document.getElementById('noteArea').addEventListener('input', saveCurrentContent);

renderTabs();
</script>

</body>
</html>

